;/*FB_PKG_DELIM*/

__d("LSShimHybridThreadDeleteUtil",["Promise","ReQL"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b){return d("ReQL").firstAsync(d("ReQL").fromTableAscending(a.mi_act_mapping_table).getKeyRange(b)).then(function(a){return a})}function c(a,c){if(c!=null)return(h||(h=b("Promise"))).all([a.threads["delete"](c.serverThreadKey),a.mi_act_mapping_table["delete"](c.serverThreadKey,c.clientThreadPk,c.jid)]).then(function(){});else return(h||(h=b("Promise"))).resolve()}g.getMiActMappingRow=a;g.deleteE2EEMetadataTable=c}),98);
__d("LSShimHybridThreadAuthoritativeDelete.nop",["FBLogger","I64","LSShimHybridThreadDeleteUtil","MAWBridgeSendAndReceive","asyncToGeneratorRuntime","getChatJidForLSDBJid"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,e){var f=(yield d("LSShimHybridThreadDeleteUtil").getMiActMappingRow(a,e));if(f!=null){b=(yield d("getChatJidForLSDBJid").getMaybeChatJidForLSDBJid(a,e,f.jid));if(b==null)throw c("FBLogger")("messenger_e2ee_web").mustfixThrow("missing_thread_in_LSDB for threadKey"+(h||(h=d("I64"))).to_string(e));yield d("MAWBridgeSendAndReceive").sendAndReceive("backend","deleteThread",{chatJid:b}).then(function(){return f})}return d("LSShimHybridThreadDeleteUtil").deleteE2EEMetadataTable(a,f)});function e(b,c,d){return a.apply(this,arguments)}return e}();a.__nop_name__="LSShimHybridThreadAuthoritativeDelete";g["default"]=a}),98);
__d("LSHybridThreadAuthoritativeDelete",["LSShimHybridThreadAuthoritativeDelete.nop"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[];return c.sequence([function(d){return c.nativeOperation(b("LSShimHybridThreadAuthoritativeDelete.nop"),a[0])},function(a){return c.resolve(d)}])}a.__sproc_name__="LSE2EEMessagingMetadataMailboxHybridThreadAuthoritativeDeleteStoredProcedure";a.__tables__=[];e.exports=a}),null);
__d("LSDeletePartialThread",["LSHybridThreadAuthoritativeDelete"],(function(a,b,c,d,e,f){function a(){var a=arguments,c=a[a.length-1],d=[],e=[];return c.sequence([function(e){return c.sequence([function(b){return c.db.table(9).fetch([[[a[0]]]]).next().then(function(a,b){var c=a.done;a=a.value;return c?d[0]=void 0:(b=a.item,d[0]=b.authorityLevel)})},function(e){return c.i64.neq(d[0],void 0)?c.i64.eq(d[0],c.i64.cast([0,60]))?c.storedProcedure(b("LSHybridThreadAuthoritativeDelete"),a[0]):c.resolve():c.resolve()}])},function(a){return c.resolve(e)}])}a.__sproc_name__="LSE2EEMessagingMetadataMailboxDeletePartialThreadStoredProcedure";a.__tables__=["threads"];e.exports=a}),null);
__d("LSUpdateThreadMuteSetting",[],(function(a,b,c,d,e,f){function a(){var a=arguments,b=a[a.length-1],c=[];return b.sequence([function(c){return b.forEach(b.db.table(9).fetch([[[a[0]]]]),function(b){var c=b.update;b.item;return c({muteExpireTimeMs:a[1]})})},function(a){return b.resolve(c)}])}a.__sproc_name__="LSMailboxUpdateThreadMuteSettingStoredProcedure";a.__tables__=["threads"];e.exports=a}),null);